/*! jquery asSpinner - v0.2.0 - 2014-05-30
* https://github.com/amazingSurge/jquery-asSpinner
* Copyright (c) 2014 amazingSurge; Licensed GPL */
(function(s){"use strict";var i=s.asSpinner=function(t,n){if(this.element=t,this.$element=s(t),this.options=s.extend({},i.defaults,n,this.$element.data()),this.namespace=this.options.namespace,this.options.rule){var e=this,o=["min","max","step","precision"];s.each(o,function(s,t){e[t]=i.rules[e.options.rule][t]})}else this.min=this.options.min,this.max=this.options.max,this.step=this.options.step,this.precision=this.options.precision;this.disabled=this.options.disabled,this.$element.prop("disabled")&&(this.disabled=!0),this.value=this.options.parse(this.$element.val()),this.mousewheel=this.options.mousewheel,this.mousewheel&&!s.event.special.mousewheel&&(this.mousewheel=!1),this.eventBinded=!1,this.spinTimeout=null,this.isFocused=!1,this.classes={disabled:this.namespace+"_disabled",skin:this.namespace+"_"+this.options.skin,focus:this.namespace+"_focus",control:this.namespace+"-control",down:this.namespace+"-down",up:this.namespace+"-up",wrap:this.namespace},this._trigger("init"),this.init()};i.prototype={constructor:i,init:function(){this.$control=s('<div class="'+this.namespace+'-control"><span class="'+this.classes.up+'"></span><span class="'+this.classes.down+'"></span></div>'),this.$wrap=this.$element.wrap('<div tabindex="0" class="'+this.classes.wrap+'"></div>').parent(),this.$down=this.$control.find("."+this.classes.down),this.$up=this.$control.find("."+this.classes.up),this.options.skin&&this.$wrap.addClass(this.classes.skin),this.$control.appendTo(this.$wrap),this.disabled===!1?this.bindEvent():this.disable(),this._trigger("ready")},_trigger:function(s){this.$element.trigger("asSpinner::"+s,this),this.$element.trigger(s+".asSpinner",this),s=s.replace(/\b\w+\b/g,function(s){return s.substring(0,1).toUpperCase()+s.substring(1)});var i="on"+s,t=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;"function"==typeof this.options[i]&&this.options[i].apply(this,t)},spin:function(s,i){var t=this,n=function(i){clearTimeout(t.spinTimeout),t.spinTimeout=setTimeout(function(){s.call(t),n(60)},i)};n(i||500)},bindEvent:function(){var i=this;this.eventBinded=!0,this.$wrap.on("focus.asSpinner",function(){i.$wrap.addClass(i.classes.focus)}).on("blur.asSpinner",function(){i.isFocused||i.$wrap.removeClass(i.classes.focus)}),this.$down.on("mousedown.asSpinner",function(){s(document).one("mouseup.asSpinner",function(){clearTimeout(i.spinTimeout)}),i.spin(i.spinDown)}).on("mouseup.asSpinner",function(){clearTimeout(i.spinTimeout),s(document).off("mouseup.asSpinner")}).on("click.asSpinner",function(){i.spinDown.call(i)}),this.$up.on("mousedown.asSpinner",function(){s(document).one("mouseup.asSpinner",function(){clearTimeout(i.spinTimeout)}),i.spin(i.spinUp)}).on("mouseup.asSpinner",function(){clearTimeout(i.spinTimeout),s(document).off("mouseup.asSpinner")}).on("click.asSpinner",function(){i.spinUp.call(i)}),this.$element.on("focus.asSpinner",function(){i.isFocused=!0,i.$wrap.addClass(i.classes.focus),s(this).on("keydown.asSpinner",function(s){var t=s.keyCode||s.which;return 38===t?(i.applyValue(),i.spinUp(),!1):40===t?(i.applyValue(),i.spinDown(),!1):(57>=t&&t>=48&&setTimeout(function(){},0),void 0)}),i.mousewheel===!0&&s(this).mousewheel(function(s,t){return t>0?i.spinUp():i.spinDown(),!1})}).on("blur.asSpinner",function(){i.isFocused=!1,i.$wrap.removeClass(i.classes.focus),s(this).off("keydown.asSpinner"),i.mousewheel===!0&&s(this).unmousewheel(),i.applyValue()})},unbindEvent:function(){this.eventBinded=!1,this.$element.off(".asSpinner"),this.$down.off(".asSpinner"),this.$up.off(".asSpinner"),this.$wrap.off(".asSpinner")},isNumber:function(i){return"number"==typeof i&&s.isNumeric(i)?!0:!1},isOutOfBounds:function(s){return this.min>s?-1:s>this.max?1:0},applyValue:function(){this.options.format(this.value)!==this.$element.val()&&this.set(this.options.parse(this.$element.val()))},_set:function(s){isNaN(s)&&(s=this.min);var i=this.isOutOfBounds(s);0!==i&&(s=this.options.looping===!0?1===i?this.min:this.max:-1===i?this.min:this.max),this.value=s=Number(s).toFixed(this.precision),this.$element.val(this.options.format(this.value))},set:function(s){this._set(s),this._trigger("change",this.value)},get:function(){return this.value},update:function(s){var i=this;return["min","max","precision","step"].map(function(t){s[t]&&(i[t]=s[t])}),s.value&&this.set(s.value),this},val:function(s){return s?(this.set(this.options.parse(s)),void 0):this.get()},spinDown:function(){return s.isNumeric(this.value)||(this.value=0),this.value=parseFloat(this.value)-parseFloat(this.step),this.set(this.value),this},spinUp:function(){return s.isNumeric(this.value)||(this.value=0),this.value=parseFloat(this.value)+parseFloat(this.step),this.set(this.value),this},enable:function(){return this.disabled=!1,this.$wrap.removeClass(this.classes.disabled),this.$element.prop("disabled",!1),this.eventBinded===!1&&this.bindEvent(),this},disable:function(){return this.disabled=!0,this.$element.prop("disabled",!0),this.$wrap.addClass(this.classes.disabled),this.unbindEvent(),this},destroy:function(){return this.unbindEvent(),this.$control.remove(),this.$element.unwrap(),this}},i.rules={defaults:{min:null,max:null,step:1,precision:0},currency:{min:0,max:99999,step:.01,precision:2},quantity:{min:1,max:999,step:1,precision:0},percent:{min:1,max:100,step:1,precision:0},month:{min:1,max:12,step:1,precision:0},day:{min:1,max:31,step:1,precision:0},hour:{min:0,max:23,step:1,precision:0},minute:{min:1,max:59,step:1,precision:0},second:{min:1,max:59,step:1,precision:0}},i.defaults={namespace:"asSpinner",skin:null,disabled:!1,min:-10,max:10,step:1,name:null,precision:0,rule:null,looping:!0,mousewheel:!1,format:function(s){return s},parse:function(s){return parseFloat(s)}},s.fn.asSpinner=function(t){if("string"!=typeof t)return this.each(function(){s.data(this,"asSpinner")||s.data(this,"asSpinner",new i(this,t))});var n=t,e=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;if(/^\_/.test(n))return!1;if(!(/^(get)$/.test(n)||"val"===n&&void 0===e))return this.each(function(){var i=s.data(this,"asSpinner");i&&"function"==typeof i[n]&&i[n].apply(i,e)});var o=this.first().data("asSpinner");return o&&"function"==typeof o[n]?o[n].apply(o,e):void 0}})(window.jQuery);